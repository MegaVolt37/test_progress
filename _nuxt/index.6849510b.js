import{r as P,z as O,A as T,B as R,C as L,u as N,D as v,E,F as M,_ as H,k as d,l as h,m as g,c as z,G as w,H as $,I as b,J as A,K as F,L as S,M as V,t as C,N as x,v as k,O as j,P as U,Q as J,R as q,S as K,q as B}from"./entry.54b3c21b.js";import{_ as X}from"./nuxt-icon.vue.fc95bb8f.js";const G=()=>null;function Q(...u){const i=typeof u[u.length-1]=="string"?u.pop():void 0;typeof u[0]!="string"&&u.unshift(i);let[s,c,e={}]=u;if(typeof s!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof c!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");e.server=e.server??!0,e.default=e.default??G,e.lazy=e.lazy??!1,e.immediate=e.immediate??!0;const t=N(),y=()=>t.isHydrating?t.payload.data[s]:t.static.data[s],f=()=>y()!==void 0;t._asyncData[s]||(t._asyncData[s]={data:P(y()??e.default()),pending:P(!f()),error:O(t.payload._errors,s),status:P("idle")});const a={...t._asyncData[s]};a.refresh=a.execute=(l={})=>{if(t._asyncDataPromises[s]){if(l.dedupe===!1)return t._asyncDataPromises[s];t._asyncDataPromises[s].cancelled=!0}if((l._initial||t.isHydrating&&l._initial!==!1)&&f())return y();a.pending.value=!0,a.status.value="pending";const _=new Promise((r,m)=>{try{r(c(t))}catch(I){m(I)}}).then(r=>{if(_.cancelled)return t._asyncDataPromises[s];let m=r;e.transform&&(m=e.transform(r)),e.pick&&(m=W(m,e.pick)),a.data.value=m,a.error.value=null,a.status.value="success"}).catch(r=>{if(_.cancelled)return t._asyncDataPromises[s];a.error.value=r,a.data.value=v(e.default()),a.status.value="error"}).finally(()=>{_.cancelled||(a.pending.value=!1,t.payload.data[s]=a.data.value,a.error.value&&(t.payload._errors[s]=E(a.error.value)),delete t._asyncDataPromises[s])});return t._asyncDataPromises[s]=_,t._asyncDataPromises[s]};const o=()=>a.refresh({_initial:!0}),n=e.server!==!1&&t.payload.serverRendered;{const l=M();if(l&&!l._nuxtOnBeforeMountCbs){l._nuxtOnBeforeMountCbs=[];const r=l._nuxtOnBeforeMountCbs;l&&(T(()=>{r.forEach(m=>{m()}),r.splice(0,r.length)}),R(()=>r.splice(0,r.length)))}n&&t.isHydrating&&f()?(a.pending.value=!1,a.status.value=a.error.value?"error":"success"):l&&(t.payload.serverRendered&&t.isHydrating||e.lazy)&&e.immediate?l._nuxtOnBeforeMountCbs.push(o):e.immediate&&o(),e.watch&&L(e.watch,()=>a.refresh());const _=t.hook("app:data:refresh",r=>{if(!r||r.includes(s))return a.refresh()});l&&R(_)}const p=Promise.resolve(t._asyncDataPromises[s]).then(()=>a);return Object.assign(p,a),p}function W(u,i){const s={};for(const c of i)s[c]=u[c];return s}const Y={},Z={width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ee=g("path",{d:"M8.9059 1.13178C8.9154 1.10294 8.92794 1.09136 8.93812 1.08452C8.95159 1.07546 8.9731 1.06763 9 1.06763C9.02689 1.06763 9.04841 1.07546 9.06188 1.08452C9.07206 1.09136 9.0846 1.10294 9.0941 1.13178L10.8086 6.33558C10.9574 6.78724 11.3812 7.08682 11.8525 7.08682H17.4006C17.4359 7.08682 17.4531 7.09655 17.4627 7.10389C17.4752 7.11343 17.4876 7.12945 17.4947 7.15098C17.5018 7.17252 17.5009 7.19123 17.4972 7.20373C17.4946 7.21254 17.4881 7.22832 17.461 7.24775L12.9725 10.4639C12.587 10.7401 12.4222 11.2335 12.5715 11.6864L14.2859 16.8902C14.2954 16.919 14.2917 16.9339 14.2886 16.9426C14.284 16.9552 14.2729 16.9723 14.2523 16.987C14.2317 17.0017 14.2099 17.0082 14.1922 17.0088C14.1783 17.0092 14.1587 17.0065 14.1314 16.987L9.64288 13.7709C9.25908 13.4959 8.74092 13.4959 8.35712 13.7709L3.86859 16.987C3.84135 17.0065 3.82174 17.0092 3.8078 17.0088C3.79014 17.0082 3.76828 17.0017 3.74772 16.987C3.72714 16.9723 3.71601 16.9552 3.71144 16.9426C3.70827 16.9339 3.70459 16.919 3.71405 16.8902L5.42852 11.6864C5.57775 11.2335 5.41295 10.7401 5.02751 10.4639L0.538985 7.24775C0.511869 7.22832 0.505441 7.21254 0.502831 7.20373C0.499129 7.19123 0.498223 7.17251 0.505318 7.15098C0.512411 7.12945 0.524794 7.11342 0.537297 7.10389C0.546916 7.09655 0.56409 7.08682 0.599422 7.08682H6.14755C6.61885 7.08682 7.04263 6.78724 7.19143 6.33559L8.9059 1.13178Z",stroke:"#3300FF"},null,-1),se=[ee];function te(u,i){return d(),h("svg",Z,se)}const ae=H(Y,[["render",te]]);function ne(u,i={}){const s=[u];for(const[c,e]of Object.entries(i))e===!0?s.push(`${u}--${c}`):e&&s.push(`${u}--${c}--${e}`);return s.join(" ")}const re={class:"app-progress"},oe={class:"app-progress__bar-line"},le=g("span",{class:"app-progress__value"},"0",-1),ce={key:0},ue={__name:"AppProgress",props:{stages:{type:Array}},setup(u){const i=u;function s(o){let n=0;const p=[...o];for(;p.length>0;){const l=p.pop();Array.isArray(l.games)&&l.games.forEach(_=>{n+=_.bestResult})}return n}const c=z(()=>s(i.stages)),e=(o=(n=>(n=i.stages)==null?void 0:n.length)())=>`grid-template-columns: repeat(${o}, 1fr);`,t=o=>{const n=c.value>=o.thresholdPoints;return o.games.some(p=>p.isPlayed)&&n},y=(o,n)=>{var l;const p=n>0?i.stages[n-1]:null;return f(c.value,p?p==null?void 0:p.thresholdPoints:0,o.thresholdPoints)||n===0&&c.value===0||n===((l=i.stages)==null?void 0:l.length)-1&&c.value>=i.stages[n].thresholdPoints},f=(o,n,p)=>o>n&&o<=p,a=o=>{const n=i.stages[o],p=o>0?i.stages[o-1]:null,l=p?p.thresholdPoints:0,_=n.thresholdPoints;if(c.value>=_)return 100;if(c.value>=l){const r=_-l;return(c.value-l)/r*100}else return 0};return(o,n)=>{const p=ae,l=X;return d(),h("div",re,[g("div",{class:"app-progress__icons",style:b(e())},[(d(!0),h(w,null,$(u.stages,(_,r)=>{var m;return d(),h("span",{class:"app-progress__icon",key:r},[r!==((m=u.stages)==null?void 0:m.length)-1?(d(),A(p,{key:0,class:F(("bem"in o?o.bem:v(ne))("app-progress__icons-star",{fill:t(_)}))},null,8,["class"])):(d(),A(l,{key:1,class:"app-progress__icons-cup",name:"cup",filled:"",width:"46",height:"24"}))])}),128))],4),g("div",{class:"app-progress__bar",style:b(e())},[(d(!0),h(w,null,$(u.stages,(_,r)=>{var m;return d(),h("div",{class:"app-progress__bar-wrapper",key:r},[S(g("span",oe,null,512),[[V,r<((m=u.stages)==null?void 0:m.length)-1]]),g("div",{class:"app-progress__bar-fill",style:b({width:`${a(r)}%`})},null,4)])}),128))],4),g("div",{class:"app-progress__values",style:b(e())},[le,(d(!0),h(w,null,$(u.stages,(_,r)=>(d(),h("span",{class:"app-progress__value",key:r,style:b({transform:y(_,r)?"translateX(30%)":""})},[y(_,r)?(d(),h("span",ce,C(v(c))+" / ",1)):x("",!0),k(C(_.thresholdPoints),1)],4))),128))],4)])}}},ie=ue,D=j("progress",()=>{const u=[{name:"Этап первый",id:1,thresholdPoints:25,games:[{name:"Игра 1.1",bestResult:0,isPlayed:!1}]},{name:"Этап второй",id:2,thresholdPoints:50,games:[{name:"Игра 2.1",bestResult:0,isPlayed:!1}]},{id:3,name:"Этап третий",thresholdPoints:100,games:[{name:"Игра 3.1",bestResult:0,isPlayed:!1}]},{id:4,name:"Этап четвертый",thresholdPoints:200,games:[{name:"Игра 4.1",bestResult:0,isPlayed:!1}]},{id:5,name:"Этап пятый",thresholdPoints:500,games:[{name:"Игра 5.1",bestResult:0,isPlayed:!1}]},{id:6,name:"Этап шестой",thresholdPoints:1e3,games:[{name:"Игра 6.1",bestResult:0,isPlayed:!1},{name:"Игра 6.2",bestResult:0,isPlayed:!1}]}],i=P([]);return{stages:i,getStages:async()=>{try{const e=await $fetch("list");i.value=e.stages}catch(e){i.value=JSON.parse(JSON.stringify(u)),console.error(e)}},updateProgress:async({id:e,game:t,progress:y})=>{if(!y)return;const f=i.value.find(n=>n.id===e);if(!f)return;const a=f.games.find(n=>n.name===t);if(!a)return;a.bestResult=+y,f.games.reduce((n,p)=>n+p.bestResult,0)>=f.thresholdPoints&&f.games.forEach(n=>{n.isPlayed=!0})}}});const pe={class:"app-change-progress"},_e={class:"app-change-progress__title"},de={class:"app-change-progress__items"},ge={class:"app-change-progress__name"},he={class:"app-change-progress__progress"},fe=["id"],me=["onClick"],ye={__name:"AppChangeProgress",props:{stages:{type:Array,required:!0}},setup(u){const{updateProgress:i}=D(),s=P(!1),c=P(null),e=P(null),t=P(null),y=(a,o)=>c.value===o&&e.value===a?"Сохранить":"Изменить прогресс",f=(a,o,n)=>{s.value?c.value===n&&e.value===a&&(i({id:a,game:o,progress:t.value}),s.value=!1,c.value=null,e.value=null,t.value=null):(c.value=n,e.value=a,s.value=!0)};return(a,o)=>(d(),h("div",pe,[(d(!0),h(w,null,$(u.stages,(n,p)=>(d(),h("div",{class:"app-change-progress__wrapper",key:p},[g("span",_e,C(n.name),1),g("ul",de,[(d(!0),h(w,null,$(n.games,(l,_)=>(d(),h("li",{class:"app-change-progress__item",key:_},[g("p",ge,[k(" Название игры: "),g("span",null,C(l.name),1)]),g("p",he,[k(" Прогресс: "),g("span",null,C(l.bestResult),1)]),v(s)&&v(e)===n.id&&v(c)===_?S((d(),h("input",{key:0,class:"app-change-progress__field",type:"tel",id:p,"onUpdate:modelValue":o[0]||(o[0]=r=>J(t)?t.value=r:null)},null,8,fe)),[[U,v(t)]]):x("",!0),g("button",{class:"app-change-progress__button",onClick:r=>f(n.id,l.name,_)},C(y(n.id,_)),9,me)]))),128))])]))),128))]))}},ve=ye;const Pe={class:"page-home"},Ce={class:"container"},be={class:"page-home__progress"},we=g("p",{class:"page-home__progress-title"},"Изменение прогресса",-1),De={__name:"index",async setup(u){let i,s;const{getStages:c}=D(),{stages:e}=q(D());return[i,s]=K(()=>Q(()=>c(),"$PslAyef5YX")),await i,s(),(t,y)=>{const f=ie,a=ve;return d(),h("div",Pe,[g("div",Ce,[B(f,{stages:v(e)},null,8,["stages"]),g("div",be,[we,B(a,{stages:v(e)},null,8,["stages"])])])])}}};export{De as default};
